Chapter 6
거래

거래는 외부 소유 계정(EOA)에서 시작하여 이더리움 네트워크에서 전송되고 이더리움 블록 체인에 기록된 서명 된 메시지이다. 이 기본 정의는 놀라울 정도의 매력적인 세부 사항을 숨긴다.
거래을 보는 또 다른 방법은 거래가 EVM에서 상태 변경을 유발하거나 계약을 실행할 수있는 유일한 방법이다.
이더리움은 글로벌 싱글톤(singleton) 상태 머신이며 거래는 상태 머신의 상태를 변경할 수 있는 유일한 것이다.
계약는 독자적으로 실행되지 않는다. 또한 이더리움도 자율적으로 실행되지 않는다.
모든 것은 거래로부터 시작된다.

이 장에서는 거래을 분석하고 작동 방식을 보여 주며 세부 사항을 이해합니다.
이 장의 많은 부분은 낮은 수준에서 자신의 거래을 관리하는 데 관심이있는 사람들을 대상으로합니다. 그들은 지갑 응용 프로그램을 작성하기 때문에;
당신은 흥미있는 세부 사항을 발견 할지도 모르다, 당신이 기존하는 지갑 신청을 사용하여 행복하면 이것에 관하여 고민 할 필요 없다!


거래 구조

먼저 이더리움 네트워크에서 직렬화되고 전송되는 거래의 기본 구조를 살펴 보자.
직렬화 된 거래을 수신하는 각 클라이언트와 어플리케이션은 자체 내부 데이터 구조를 사용하여 메모리에 저장하며, 네트워크 직렬화 된 거래 자체에는 존재하지 않는 메타 데이터가 포함되어 있다.
네트워크 직렬화는 거래의 유일한 표준 형식입니다.

거래은 다음 데이터를 포함하는 직렬화 된 바이너리 메시지이다.

넌스(nonce)
발신 EOA에 의해 발행되어 메시지 재생을 방지하는 데 사용되는 일련 번호
가스 가격(gas price)
원작자가 기꺼이 지불하는 가스 가격(웨이).
가스 한도(gas limit)
이 거래를 위해 기꺼이 구입할 가스의 최대량.
목적지(to)
목적지 이더리움 주소.
값(value)
목적지에 보낼 이더의 양.
데이터(data)
가변 길이 바이너리 데이터 페이로드.
v, r, s
원래 EOA의 ECDSA 디지털 서명의 세 가지 구성 요소.

거래 메시지의 구조는 이더리움에서 간단하고 완벽한 바이트 직렬화를 위해 특별히 만들어진 RLP(Recursive Length Prefix) 인코딩 체계를 사용하여 직렬화된다.
이더리움의 모든 숫자는 8비트 배수 길이의 빅-엔디안 정수로 인코딩된다.

명확성을 위해 여기에 필드 레이블 ("목적지", "가스 한도"등)이 표시되지만 RLP로 인코딩된 필드 값이 들어있는 직렬화된 거래 데이터의 일부가 아니라는 점에 유의하시오.
일반적으로, RLP는 필드 구분자 또는 라벨을 포함하지 않는다.
RLP의 길이 접두사는 각 필드의 길이를 식별하는 데 사용된다. 따라서 정의 된 길이를 초과하는 것은 구조의 다음 필드에 속한다.

이것이 실제 거래 구조가 전송되는 동안, 대부분의 내부 표현과 사용자 인터페이스 시각화는 거래나 블록 체인에서 파생된 추가 정보로 이것을 보완합니다.
